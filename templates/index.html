<!DOCTYPE html>
<html>
<head>
    <title>Product Checker</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/css/bootstrap-select.min.css" />
    <style>
    /* Custom CSS for autocomplete dropdown */
.ui-autocomplete {
  max-height: 200px;
  overflow-y: auto;
  overflow-x: hidden;
  z-index: 1000;
}

.ui-autocomplete.ui-widget-content {
  position: absolute;
  top: 100%;
  left: 0;
  width: 100%;
}
</style>
</head>
<body>

    <div class="container">
        <h1 align="center">Product Checker</h1>
        <div class="row">
            <div class="col-md-6">
                <label>Select Category</label>
                <select name="category" data-live-search="true" id="category" class="form-control" title="Select Category">
                    {% for row in categories %}
                    <option value="{{row.id}}">{{row.name}}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-6">
                <label>Select Product</label>
                <input type="text" name="product" id="product" class="form-control" placeholder="Select Product" autocomplete="on">
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/js/bootstrap-select.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#category").selectpicker();

            // Enable autocomplete for the product input field
            $('#product').autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: "/getProducts",
                        type: "POST",
                        data: {
                            category_id: $("#category").val(),
                            query: request.term
                        },
                        success: function (data) {
                            //alert("Yes");
                            response(data.products);
                            response(data.products.map(function (item) {
        return { label: item.name, value: item.id };
    }));
                        }
                    });
                },
                minLength: 3 // Minimum characters required before triggering autocomplete
            });
        });

    </script>
</body>
</html>
